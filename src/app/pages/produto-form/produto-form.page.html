<ion-header>
  <ion-toolbar color="secondary">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/admin"></ion-back-button>
    </ion-buttons>
    <ion-title>{{ isEditMode ? 'Editar Produto' : 'Novo Produto' }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <form #productForm="ngForm" (ngSubmit)="saveProduct()">
    <ion-card>
      <ion-card-content>
        <ion-item>
          <ion-label position="floating">Nome do Produto *</ion-label>
          <ion-input 
            type="text" 
            [(ngModel)]="product.nome" 
            name="nome" 
            required>
          </ion-input>
        </ion-item>

        <ion-item>
          <ion-label position="floating">Descrição *</ion-label>
          <ion-textarea 
            [(ngModel)]="product.descricao" 
            name="descricao" 
            rows="3"
            required>
          </ion-textarea>
        </ion-item>

        <ion-item>
          <ion-label position="floating">Preço (R$) *</ion-label>
          <ion-input 
            type="number" 
            [(ngModel)]="product.preco" 
            name="preco" 
            min="0"
            step="0.01"
            required>
          </ion-input>
        </ion-item>

        <ion-item>
          <ion-label position="floating">Estoque *</ion-label>
          <ion-input 
            type="number" 
            [(ngModel)]="product.estoque" 
            name="estoque" 
            min="0"
            required>
          </ion-input>
        </ion-item>

        <ion-item>
          <ion-label position="floating">URL da Imagem *</ion-label>
          <ion-input 
            type="url" 
            [(ngModel)]="product.imagem" 
            name="imagem" 
            required>
          </ion-input>
        </ion-item>

        <div class="image-preview" *ngIf="product.imagem">
          <p>Preview:</p>
          <img [src]="product.imagem" alt="Preview" (error)="onImageError()">
        </div>

        <div class="button-group">
          <ion-button 
            expand="block" 
            type="submit" 
            color="success"
            [disabled]="!productForm.valid">
            <ion-icon name="checkmark-circle" slot="start"></ion-icon>
            {{ isEditMode ? 'Atualizar' : 'Cadastrar' }}
          </ion-button>

          <ion-button 
            expand="block" 
            fill="outline" 
            color="medium"
            routerLink="/admin">
            Cancelar
          </ion-button>
        </div>
      </ion-card-content>
    </ion-card>
  </form>
</ion-content>